<!------ TABLA ------>

<div class="container">
  <div class="row">

    <div class="col-12">
      <h1 class="text-center mt-3 text-dark-emphasis">{{'Detalle de inventario'}}</h1>
      <h6 class="text-secondary mt-3" *ngIf="fechaApertura">Fecha Apertura: {{fechaApertura | date}}</h6>
      <h6 class="text-secondary mt-3" *ngIf="idCabeceraInv">Nro Inventario: {{idCabeceraInv}}</h6>
      <h6 class="mt-3 fw-bold" [ngClass]="{'text-danger': !invHabilitado, 'text-secondary': invHabilitado}">{{descripcion}}</h6>
    </div>

    <div class="col offset-md-9 col-md-3" *ngIf="invHabilitado">
      <div class="d-grid gap-2 my-2">
        <button class="btn btn-danger" (click)="enviar()">Enviar</button>
      </div>
    </div>

    <div class="col-12">
      <div class="text-center" *ngIf="cargandoOperacion">
          <div class="spinner-border text-danger" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
          <!-- <div class="text-center text-danger">
            Registrando el inventario..
          </div> -->
      </div>
    </div>

    <div class="col-12" *ngIf="cargandoTabla">
        <div class="text-center">
          <div class="spinner-border text-danger" style="width: 3rem; height: 3rem;" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
        </div>
        <!-- <div class="text-center text-danger">
          Obteniendo productos...
        </div> -->
    </div>

    <div class="col-12"  *ngIf="!cargandoTabla && !cargandoOperacion">
        <form [formGroup]="form" *ngIf="invHabilitado">
            <table datatable [dtOptions]="dtOptions" class="table hover mt-2"><!-- *ngIf="!cargandoTabla && !cargandoOperacion"--> 

                <thead class="bg-warning">
                    <tr>
                        <th class="text-center">Nombre</th>
                        <th class="text-center">Precio</th>
                        <th class="text-center">Cantidad</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let i of productos; let j=index;">
                        <td class="text-start">{{i.nombre | titlecase}}</td>
                        <td class="text-end">{{i.precio | number}}</td>
                        <td class="col-2">
                          <div>
                              <!--El id se utiliza para agregar el contorno rojo a los inputs en donde no se ha establecido la cantidad-->
                              <input type="number" class="form-control" formControlName="{{ i.idProducto }}" [id]="i.idProducto">
                              <span *ngIf="datoInvalido(i.idProducto.toString())" class="e-mensaje-error bg-success">{{mensaje(i.idProducto.toString())}}</span>   
                          </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </form>
    </div>
  
  </div>
</div>

 



